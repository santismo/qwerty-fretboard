<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Qwerty Fretboard</title>
    <style>
      :root {
        color-scheme: dark;
        font-family: "Avenir Next", "Futura", "Trebuchet MS", sans-serif;
        color: #f5f5f5;
        --bg: #050505;
        --panel: #0c0c0c;
        --panel-strong: #111111;
        --border: #1f1f1f;
        --text-muted: #9a9a9a;
        --text-soft: #bdbdbd;
        --accent: #ffffff;
        --glow: rgba(255, 255, 255, 0.08);
      }

      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        min-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 20px;
        background: radial-gradient(circle at top, #171717, var(--bg) 55%);
      }

      main {
        width: min(980px, 100%);
        background: var(--panel);
        border: 1px solid var(--border);
        border-radius: 18px;
        padding: 24px;
        box-shadow: 0 30px 60px rgba(0, 0, 0, 0.4);
      }

      header {
        display: grid;
        gap: 16px;
        grid-template-columns: 1fr auto;
        align-items: center;
      }

      h1 {
        margin: 0 0 6px;
        font-size: 1.6rem;
        font-weight: 600;
        letter-spacing: 0.02em;
      }

      .settings {
        position: relative;
      }

      .settings summary {
        list-style: none;
        width: 38px;
        height: 38px;
        border-radius: 10px;
        border: 1px solid var(--border);
        background: var(--panel-strong);
        display: grid;
        place-items: center;
        cursor: pointer;
        font-size: 1.1rem;
      }

      .settings summary::-webkit-details-marker {
        display: none;
      }

      .settings[open] summary {
        border-color: var(--accent);
        box-shadow: 0 0 0 2px var(--glow);
      }

      .settings .controls {
        position: absolute;
        right: 0;
        top: 46px;
        z-index: 5;
      }

      .controls {
        display: grid;
        gap: 10px;
        padding: 12px;
        border: 1px solid var(--border);
        border-radius: 12px;
        background: var(--panel-strong);
        min-width: 250px;
      }

      label {
        font-size: 0.8rem;
        color: var(--text-soft);
      }

      select,
      button,
      input[type="range"] {
        width: 100%;
        background: #0a0a0a;
        border: 1px solid #262626;
        color: var(--accent);
        padding: 8px 10px;
        border-radius: 8px;
        font-size: 0.9rem;
      }

      button {
        cursor: pointer;
        transition: border-color 0.15s ease, box-shadow 0.15s ease;
      }

      button:hover {
        border-color: var(--accent);
        box-shadow: 0 0 0 2px var(--glow);
      }

      button[aria-pressed="true"] {
        border-color: var(--accent);
        background: #141414;
      }

      .status {
        font-size: 0.8rem;
        color: #d1d1d1;
      }

      .toggle {
        display: flex;
        gap: 8px;
      }

      .fretboard,
      .neck-view {
        margin-top: 20px;
      }

      .string-row {
        display: grid;
        grid-template-columns: 90px 1fr;
        gap: 12px;
        align-items: center;
        padding: 8px 10px;
        border-bottom: 1px solid #141414;
      }

      .string-row:last-child {
        border-bottom: none;
      }

      .string-label {
        font-size: 0.85rem;
        color: #d6d6d6;
      }

      .frets {
        display: grid;
        grid-auto-flow: column;
        grid-auto-columns: minmax(38px, 1fr);
        gap: 8px;
        transition: transform 0.15s ease;
      }

      .fret {
        background: #0f0f0f;
        border-radius: 6px;
        padding: 6px 4px;
        text-align: center;
        border: 1px solid #1a1a1a;
        font-size: 0.75rem;
        color: var(--text-soft);
        display: grid;
        gap: 2px;
        min-height: 44px;
      }

      .fret span {
        font-size: 0.65rem;
        color: #7a7a7a;
      }

      .fret.active {
        border-color: #ffffff;
        color: #ffffff;
        background: #1a1a1a;
      }

      .classic-markers {
        margin-top: 8px;
        display: grid;
        grid-template-columns: 90px 1fr;
        gap: 12px;
        align-items: center;
      }

      .classic-markers-row {
        display: grid;
        grid-template-columns: repeat(var(--fret-count), 1fr);
        gap: 8px;
        height: 10px;
        transition: transform 0.15s ease;
      }

      .classic-markers-row span {
        width: 6px;
        height: 6px;
        border-radius: 999px;
        background: #262626;
        opacity: 0;
        justify-self: center;
      }

      .classic-markers-row span.marker-dot {
        opacity: 1;
      }

      .classic-markers-row.slanted {
        transform: translateX(var(--row-offset, 0px));
      }

      .hidden {
        display: none;
      }

      .neck-wrap {
        position: relative;
        padding: 20px 10px 10px 10px;
        background: #0d0d0d;
        border: 1px solid var(--border);
        border-radius: 12px;
        overflow: hidden;
      }

      .neck {
        display: grid;
        gap: 10px;
        margin-bottom: 8px;
      }

      .neck-string {
        display: grid;
        grid-template-columns: repeat(var(--fret-count), 1fr);
        gap: 6px;
        align-items: center;
        margin-left: var(--row-offset, 0px);
      }

      .neck-fret {
        position: relative;
        height: 30px;
        border-left: 1px solid #1f1f1f;
        border-right: 1px solid #1f1f1f;
        background: #0a0a0a;
      }

      .neck-fret.open {
        border-left: 3px solid #2a2a2a;
        background: #0c0c0c;
      }

      .neck-fret.marker::after {
        content: "";
        position: absolute;
        inset: 8px 40%;
        border-radius: 999px;
        background: #1f1f1f;
      }

      .note-dot {
        position: absolute;
        inset: 4px;
        border-radius: 999px;
        background: #ffffff;
        color: #050505;
        font-size: 0.6rem;
        display: flex;
        align-items: center;
        justify-content: center;
        opacity: 0;
        transition: opacity 0.1s ease;
      }

      .neck-fret.active .note-dot {
        opacity: 1;
      }

      .edge-labels {
        margin-top: 6px;
        display: grid;
        grid-template-columns: repeat(var(--fret-count), 1fr);
        gap: 6px;
        height: 12px;
        font-size: 0.75rem;
        color: var(--text-muted);
        text-align: center;
        letter-spacing: 0.08em;
        transform: translateX(var(--edge-offset, 0px));
      }

      .edge-labels div {
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .fretboard.slanted .string-row .frets {
        transform: translateX(var(--row-offset, 0px));
      }

      .range-row {
        display: grid;
        gap: 6px;
      }

      .range-row span {
        font-size: 0.75rem;
        color: #bdbdbd;
      }
    </style>
  </head>
  <body>
    <main>
      <header>
        <div>
          <h1>Qwerty Fretboard</h1>
        </div>
        <details class="settings" id="settings">
          <summary aria-label="Settings">⚙️</summary>
          <div class="controls">
            <div>
              <label for="midi-output">Output</label>
              <select id="midi-output"></select>
            </div>
            <button id="refresh-midi" type="button">Refresh</button>
            <div class="range-row">
              <label for="vibrato-rate">Vibrato</label>
              <input id="vibrato-rate" type="range" min="2" max="12" value="6" step="1" />
              <span id="vibrato-value">6 Hz</span>
            </div>
            <div>
              <label for="bend-range">Bend</label>
              <select id="bend-range">
                <option value="8192" selected>Whole</option>
                <option value="4096">Half</option>
                <option value="2048">Quarter</option>
              </select>
            </div>
            <div class="toggle">
              <button id="mode-classic" type="button" aria-pressed="true">Classic</button>
              <button id="mode-neck" type="button" aria-pressed="false">Neck</button>
            </div>
            <button id="toggle-slant" type="button" aria-pressed="false">Slant</button>
            <div class="status" id="midi-status">MIDI: not connected.</div>
          </div>
        </details>
      </header>

      <section class="fretboard" id="fretboard"></section>
      <div class="classic-markers" id="classic-markers">
        <div class="string-label"></div>
        <div class="classic-markers-row" id="classic-markers-row"></div>
      </div>

      <section class="neck-view hidden" id="neck-view">
        <div class="neck-wrap">
          <div class="neck" id="neck"></div>
          <div class="edge-labels" id="edge-labels"></div>
        </div>
      </section>
    </main>

    <script>
      const rowDefinitions = [
        {
          id: "row-1",
          displayName: "1 row",
          keys: [
            { code: "Digit1", label: "1" },
            { code: "Digit2", label: "2" },
            { code: "Digit3", label: "3" },
            { code: "Digit4", label: "4" },
            { code: "Digit5", label: "5" },
            { code: "Digit6", label: "6" },
            { code: "Digit7", label: "7" },
            { code: "Digit8", label: "8" },
            { code: "Digit9", label: "9" },
            { code: "Digit0", label: "0" },
            { code: "Minus", label: "-" },
          ],
        },
        {
          id: "row-q",
          displayName: "Q row",
          keys: [
            { code: "KeyQ", label: "Q" },
            { code: "KeyW", label: "W" },
            { code: "KeyE", label: "E" },
            { code: "KeyR", label: "R" },
            { code: "KeyT", label: "T" },
            { code: "KeyY", label: "Y" },
            { code: "KeyU", label: "U" },
            { code: "KeyI", label: "I" },
            { code: "KeyO", label: "O" },
            { code: "KeyP", label: "P" },
            { code: "BracketLeft", label: "[" },
          ],
        },
        {
          id: "row-a",
          displayName: "A row",
          keys: [
            { code: "KeyA", label: "A" },
            { code: "KeyS", label: "S" },
            { code: "KeyD", label: "D" },
            { code: "KeyF", label: "F" },
            { code: "KeyG", label: "G" },
            { code: "KeyH", label: "H" },
            { code: "KeyJ", label: "J" },
            { code: "KeyK", label: "K" },
            { code: "KeyL", label: "L" },
            { code: "Semicolon", label: ";" },
            { code: "Quote", label: "'" },
          ],
        },
        {
          id: "row-z",
          displayName: "Z row",
          keys: [
            { code: "KeyZ", label: "Z" },
            { code: "KeyX", label: "X" },
            { code: "KeyC", label: "C" },
            { code: "KeyV", label: "V" },
            { code: "KeyB", label: "B" },
            { code: "KeyN", label: "N" },
            { code: "KeyM", label: "M" },
            { code: "Comma", label: "," },
            { code: "Period", label: "." },
            { code: "Slash", label: "/" },
            { code: "ShiftRight", label: "Shift" },
          ],
        },
      ];

      const tuningNormal = [
        { name: "G", base: 55 },
        { name: "D", base: 50 },
        { name: "A", base: 45 },
        { name: "E", base: 40 },
      ];

      const tuningCaps = [
        { name: "e", base: 64 },
        { name: "B", base: 59 },
        { name: "G", base: 55 },
        { name: "D", base: 50 },
      ];

      const midiOutputSelect = document.getElementById("midi-output");
      const midiStatus = document.getElementById("midi-status");
      const refreshButton = document.getElementById("refresh-midi");
      const fretboard = document.getElementById("fretboard");
      const classicMarkers = document.getElementById("classic-markers");
      const classicMarkersRow = document.getElementById("classic-markers-row");
      const neckView = document.getElementById("neck-view");
      const neck = document.getElementById("neck");
      const edgeLabels = document.getElementById("edge-labels");
      const modeClassic = document.getElementById("mode-classic");
      const modeNeck = document.getElementById("mode-neck");
      const toggleSlant = document.getElementById("toggle-slant");
      const bendRangeSelect = document.getElementById("bend-range");
      const vibratoRate = document.getElementById("vibrato-rate");
      const vibratoValue = document.getElementById("vibrato-value");

      let midiAccess = null;
      let midiOutput = null;
      let capsLockOn = false;
      let octaveTranspose = 0;
      let pitchMode = "center";
      let vibratoActive = false;
      let vibratoTimer = null;
      let vibratoPhase = 0;
      let bendRange = Number(bendRangeSelect.value);
      let noteVelocity = 100;
      const activeNotes = new Map();

      const noteNames = ["C", "C#", "D", "D#", "E", "F", "F#", "G", "G#", "A", "A#", "B"];
      const cellsByCode = new Map();
      const neckCells = new Map();
      const neckCellsByCode = new Map();
      const rowOffsetStep = 14;
      const velocityStep = 5;
      const markerFrets = [3, 5, 7, 9];
      const markerSymbols = ["V", "N", "<", "?"];
      const markerFretSet = new Set(markerFrets);
      const markerLabelMap = new Map(markerFrets.map((fret, index) => [fret, markerSymbols[index]]));

      function getNoteName(midiNote) {
        const octave = Math.floor(midiNote / 12) - 1;
        const name = noteNames[midiNote % 12];
        return `${name}${octave}`;
      }

      function renderFretboard() {
        fretboard.innerHTML = "";
        cellsByCode.clear();

        rowDefinitions.forEach((row, rowIndex) => {
          const rowEl = document.createElement("div");
          rowEl.className = "string-row";
          rowEl.style.setProperty("--row-offset", `${rowIndex * rowOffsetStep}px`);

          const labelEl = document.createElement("div");
          labelEl.className = "string-label";
          labelEl.textContent = row.displayName;
          rowEl.appendChild(labelEl);

          const fretsEl = document.createElement("div");
          fretsEl.className = "frets";

          row.keys.forEach((key, index) => {
            const fretEl = document.createElement("div");
            fretEl.className = "fret";
            fretEl.dataset.code = key.code;
            fretEl.dataset.fret = index;
            fretEl.innerHTML = `<div>${key.label}</div><span></span>`;
            fretsEl.appendChild(fretEl);
            cellsByCode.set(key.code, fretEl);
          });

          rowEl.appendChild(fretsEl);
          fretboard.appendChild(rowEl);
        });

        const fretCount = rowDefinitions[0].keys.length;
        const bottomOffset = (rowDefinitions.length - 1) * rowOffsetStep;
        classicMarkersRow.innerHTML = "";
        classicMarkersRow.style.setProperty("--fret-count", fretCount);
        classicMarkersRow.style.setProperty("--row-offset", `${bottomOffset}px`);

        for (let fretIndex = 0; fretIndex < fretCount; fretIndex += 1) {
          const marker = document.createElement("span");
          if (markerFretSet.has(fretIndex)) {
            marker.classList.add("marker-dot");
          }
          classicMarkersRow.appendChild(marker);
        }
      }

      function renderNeckView() {
        neck.innerHTML = "";
        edgeLabels.innerHTML = "";
        neckCells.clear();
        neckCellsByCode.clear();

        const fretCount = rowDefinitions[0].keys.length;
        const bottomOffset = (rowDefinitions.length - 1) * rowOffsetStep;
        const markerFretsSet = new Set(markerFrets);
        neck.style.setProperty("--fret-count", fretCount);
        edgeLabels.style.setProperty("--fret-count", fretCount);
        edgeLabels.style.setProperty("--edge-offset", `${bottomOffset}px`);

        rowDefinitions.forEach((row, rowIndex) => {
          const stringRow = document.createElement("div");
          stringRow.className = "neck-string";
          stringRow.style.setProperty("--row-offset", `${rowIndex * rowOffsetStep}px`);

          for (let fretIndex = 0; fretIndex < fretCount; fretIndex += 1) {
            const fretEl = document.createElement("div");
            fretEl.className = "neck-fret";
            fretEl.dataset.fret = fretIndex;
            if (fretIndex === 0) {
              fretEl.classList.add("open");
            }
            if (markerFretsSet.has(fretIndex)) {
              fretEl.classList.add("marker");
            }
            const noteDot = document.createElement("div");
            noteDot.className = "note-dot";
            fretEl.appendChild(noteDot);
            stringRow.appendChild(fretEl);
            neckCells.set(`${rowIndex}-${fretIndex}`, { fretEl, noteDot });

            const key = row.keys[fretIndex];
            if (key) {
              neckCellsByCode.set(key.code, fretEl);
            }
          }
          neck.appendChild(stringRow);
        });

        for (let fretIndex = 0; fretIndex < fretCount; fretIndex += 1) {
          const marker = document.createElement("div");
          const markerLabel = markerLabelMap.get(fretIndex);
          if (markerLabel) {
            marker.textContent = markerLabel;
          }
          edgeLabels.appendChild(marker);
        }
      }

      function updateTuningDisplay() {
        const tuning = capsLockOn ? tuningCaps : tuningNormal;
        const rows = fretboard.querySelectorAll(".string-row");
        const transposeLabel =
          octaveTranspose === 0 ? "" : ` ${octaveTranspose >= 0 ? "+" : ""}${octaveTranspose}`;

        rows.forEach((rowEl, rowIndex) => {
          const labelEl = rowEl.querySelector(".string-label");
          const frets = rowEl.querySelectorAll(".fret");
          const stringInfo = tuning[rowIndex];
          labelEl.textContent = `${stringInfo.name}${transposeLabel}`;

          frets.forEach((fretEl) => {
            const fretNumber = Number(fretEl.dataset.fret);
            const midiNote = stringInfo.base + fretNumber + octaveTranspose * 12;
            fretEl.dataset.note = midiNote;
            const noteSpan = fretEl.querySelector("span");
            noteSpan.textContent = getNoteName(midiNote);
          });
        });

        updateNeckNotes();
      }

      function updateNeckNotes() {
        const tuning = capsLockOn ? tuningCaps : tuningNormal;
        const fretCount = rowDefinitions[0].keys.length;

        for (let stringIndex = 0; stringIndex < tuning.length; stringIndex += 1) {
          for (let fretIndex = 0; fretIndex < fretCount; fretIndex += 1) {
            const midiNote = tuning[stringIndex].base + fretIndex + octaveTranspose * 12;
            const cell = neckCells.get(`${stringIndex}-${fretIndex}`);
            if (!cell) continue;
            cell.fretEl.dataset.note = midiNote;
            cell.noteDot.textContent = getNoteName(midiNote);
          }
        }
      }

      function setCapsLockState(nextState) {
        if (capsLockOn !== nextState) {
          capsLockOn = nextState;
          updateTuningDisplay();
        }
      }

      function sendMidi(message) {
        if (midiOutput) {
          midiOutput.send(message);
        }
      }

      function sendPitchBend(value) {
        const clamped = Math.min(16383, Math.max(0, value));
        const lsb = clamped & 0x7f;
        const msb = (clamped >> 7) & 0x7f;
        sendMidi([0xe0, lsb, msb]);
      }

      function stopVibrato() {
        if (vibratoTimer) {
          clearInterval(vibratoTimer);
          vibratoTimer = null;
        }
        vibratoPhase = 0;
        if (pitchMode === "center") {
          sendPitchBend(8192);
        }
      }

      function startVibrato() {
        if (vibratoTimer) return;
        const rate = Number(vibratoRate.value);
        const depth = Math.round(bendRange * 0.27);
        vibratoTimer = setInterval(() => {
          if (pitchMode !== "center") return;
          vibratoPhase += (rate / 60) * Math.PI * 2;
          const bendAmount = Math.round(Math.sin(vibratoPhase) * depth);
          sendPitchBend(8192 + bendAmount);
        }, 16);
      }

      function handleKeyDown(event) {
        setCapsLockState(event.getModifierState("CapsLock"));

        if (["ArrowLeft", "ArrowRight", "ArrowUp", "ArrowDown", "Space", "Tab"].includes(event.code)) {
          event.preventDefault();
        }

        if (event.code === "ArrowLeft" && pitchMode !== "left") {
          pitchMode = "left";
          stopVibrato();
          sendPitchBend(8192 - bendRange);
          return;
        }

        if (event.code === "ArrowRight" && pitchMode !== "right") {
          pitchMode = "right";
          stopVibrato();
          sendPitchBend(8192 + bendRange);
          return;
        }

        if (event.code === "ArrowUp" && !event.repeat) {
          octaveTranspose += 1;
          updateTuningDisplay();
          return;
        }

        if (event.code === "ArrowDown" && !event.repeat) {
          octaveTranspose -= 1;
          updateTuningDisplay();
          return;
        }

        if (event.code === "Space") {
          vibratoActive = true;
          if (pitchMode === "center") {
            startVibrato();
          }
          return;
        }

        if (event.code === "Backquote") {
          noteVelocity = Math.min(127, noteVelocity + velocityStep);
          return;
        }

        if (event.code === "Tab") {
          noteVelocity = Math.max(1, noteVelocity - velocityStep);
          return;
        }

        const cell = cellsByCode.get(event.code);
        if (!cell || event.repeat) return;

        const midiNote = Number(cell.dataset.note);
        activeNotes.set(event.code, midiNote);
        cell.classList.add("active");
        const neckCell = neckCellsByCode.get(event.code);
        if (neckCell) {
          neckCell.classList.add("active");
        }
        sendMidi([0x90, midiNote, noteVelocity]);
      }

      function handleKeyUp(event) {
        setCapsLockState(event.getModifierState("CapsLock"));

        if (event.code === "ArrowLeft" && pitchMode === "left") {
          pitchMode = "center";
          if (vibratoActive) {
            startVibrato();
          } else {
            sendPitchBend(8192);
          }
          return;
        }

        if (event.code === "ArrowRight" && pitchMode === "right") {
          pitchMode = "center";
          if (vibratoActive) {
            startVibrato();
          } else {
            sendPitchBend(8192);
          }
          return;
        }

        if (event.code === "Space") {
          vibratoActive = false;
          stopVibrato();
          return;
        }

        const midiNote = activeNotes.get(event.code);
        if (midiNote === undefined) return;
        activeNotes.delete(event.code);
        const cell = cellsByCode.get(event.code);
        if (cell) {
          cell.classList.remove("active");
        }
        const neckCell = neckCellsByCode.get(event.code);
        if (neckCell) {
          neckCell.classList.remove("active");
        }
        sendMidi([0x80, midiNote, 0x00]);
      }

      function refreshMidiOutputs() {
        midiOutputSelect.innerHTML = "";
        if (!midiAccess) {
          midiStatus.textContent = "MIDI: not supported.";
          return;
        }

        const outputs = Array.from(midiAccess.outputs.values());
        if (!outputs.length) {
          midiStatus.textContent = "MIDI: no outputs.";
          return;
        }

        outputs.forEach((output, index) => {
          const option = document.createElement("option");
          option.value = output.id;
          option.textContent = output.name || `Output ${index + 1}`;
          midiOutputSelect.appendChild(option);
        });

        midiOutputSelect.selectedIndex = 0;
        midiOutput = outputs[0];
        midiStatus.textContent = `MIDI: ${midiOutput.name || "connected"}.`;
      }

      async function initMidi() {
        if (!navigator.requestMIDIAccess) {
          midiStatus.textContent = "MIDI: unavailable.";
          return;
        }

        try {
          midiAccess = await navigator.requestMIDIAccess();
          midiStatus.textContent = "MIDI: ready.";
          refreshMidiOutputs();
        } catch (error) {
          midiStatus.textContent = "MIDI: blocked.";
        }
      }

      midiOutputSelect.addEventListener("change", (event) => {
        const outputId = event.target.value;
        midiOutput = midiAccess?.outputs.get(outputId) || null;
        midiStatus.textContent = midiOutput
          ? `MIDI: ${midiOutput.name || "connected"}.`
          : "MIDI: choose output.";
      });

      refreshButton.addEventListener("click", () => {
        refreshMidiOutputs();
      });

      function setView(view) {
        const showClassic = view === "classic";
        fretboard.classList.toggle("hidden", !showClassic);
        classicMarkers.classList.toggle("hidden", !showClassic);
        neckView.classList.toggle("hidden", showClassic);
        modeClassic.setAttribute("aria-pressed", String(showClassic));
        modeNeck.setAttribute("aria-pressed", String(!showClassic));
      }

      modeClassic.addEventListener("click", () => {
        setView("classic");
      });

      modeNeck.addEventListener("click", () => {
        setView("neck");
      });

      toggleSlant.addEventListener("click", () => {
        const isActive = fretboard.classList.toggle("slanted");
        classicMarkersRow.classList.toggle("slanted", isActive);
        toggleSlant.setAttribute("aria-pressed", String(isActive));
      });

      bendRangeSelect.addEventListener("change", () => {
        bendRange = Number(bendRangeSelect.value);
        if (pitchMode === "left") {
          sendPitchBend(8192 - bendRange);
        } else if (pitchMode === "right") {
          sendPitchBend(8192 + bendRange);
        }
        if (vibratoActive && pitchMode === "center") {
          stopVibrato();
          startVibrato();
        }
      });

      vibratoRate.addEventListener("input", () => {
        vibratoValue.textContent = `${vibratoRate.value} Hz`;
        if (vibratoActive && pitchMode === "center") {
          stopVibrato();
          startVibrato();
        }
      });

      window.addEventListener("keydown", handleKeyDown);
      window.addEventListener("keyup", handleKeyUp);

      renderFretboard();
      renderNeckView();
      updateTuningDisplay();
      setView("classic");
      initMidi();
    </script>
  </body>
</html>
